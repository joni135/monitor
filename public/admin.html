<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Adminportal Monitor</title>
        <meta name="description" id="description" content="Seite zum Bearbeiten des Monitors">
        <meta name="autor" id="autor" content="Jonathan Kaufmann">
        <link rel="icon" type="image" id="favicon" href="">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="admin.css">
        <script src="index.js"></script>
        <script src="plugins/admin-popups.js"></script>
        <script src="plugins/admin-draganddrop.js"></script>
        <script src="plugins/admin-info.js"></script>
        <script src="plugins/admin-slide.js"></script>
    </head>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Seitenmetadaten anpassen
            document.title = 'Adminportal '+sitetitle;
            document.getElementById('autor').setAttribute('content', siteauthor);
            document.getElementById('favicon').setAttribute('href', favicon);

            document.getElementById('titleimage').setAttribute('src', favicon);
            document.getElementById('sitetitle').innerHTML = 'Adminportal '+sitetitle;
            document.getElementById('monitorpreview').setAttribute('title', sitetitle);
            document.getElementById('copyright').innerHTML = 'Copyright '+new Date().getFullYear()+' by '+siteauthor;
            
            // Funktion zum laden der Seite
            initSite();
            loadInfosAdmin();
            loadSlidesAdmin();

            // Ladescreen entfernen
            setTimeout(() => {document.getElementById('loadingscreen').style.display = 'none'; }, 500);
        });

        // Link für Monitorvorschau erstellen und in separatem Fenster öffnen
        function openMonitorpreview() {
            var currentURL = window.location.href;
            var previewURL = currentURL.replace(/(\?|&)type=([^&]*)/, '$1type=display');
            window.open(previewURL, '', 'fullscreen=yes, scrollbars=no,location=yes,resizable=no');
        };
    </script>
    <body>
        <!-- Overlay beim Laden der Seite -->
        <div id="loadingscreen">
            <i id="loadingscreen-spinner" class="fa fa-spin fa-spinner fa-2x"></i>
        </div>
        <i id="loadingspinner" class="fa fa-spin fa-spinner fa-2x"></i>

        <!-- Eigentlicher Inhalt der Seite -->
        <header>
            <img id="titleimage" src="" alt="favicon">
            <h1 id="sitetitle">Adminportal Monitor</h1>
            <a id="monitorpreview" href="javascript:void(0);" title="" onclick="openMonitorpreview()">Monitorvorschau</a>
        </header>
        <main>
            <div id="info-admin" class="container">
                <button onclick="openPopup('addInfo')">Info-Text hinzufügen</button>
                <table id="infotable"></table>
            </div>
            <div class="placeholder" style="height: 20px;"></div>
            <div id="slideshow-admin" class="container">
                <button onclick="openPopup('addImageSlide')">Bild-Slide hinzufügen</button>
                <button onclick="openPopup('addVideoSlide')">Video-Slide hinzufügen</button>
                <button onclick="openPopup('addIframeSlide')">Iframe-Slide hinzufügen</button>
                <table id="slidetable"></table>
            </div>
        </main>
        <footer>
            <p id="copyright">Copyright by Jonathan Kaufmann</p>
            <p id="copyright"><a id="github" href="https://github.com/joni135/monitor" target="_blank">Githup-Page</a></p>
        </footer>

        <!-- Overlay bei aktiviertem Popup-Fenster -->
        <div id="overlay"></div>

        <!-- Popup-Fenster für das hinzufügen einer Info -->
        <div id="addInfo" class="Popup">
            <h3 id="addInfoTitel">Info-Text hinzufügen</h3>
            <form id="addInfoForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="InfoTextInput" class="mandatory">Text:</label>
                    <input type="text" name="text" id="InfoTextInput" title="Text, der auf dem Monitor angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="InfoCommentInput">Bemerkung:</label>
                    <input type="text" name="comment" id="InfoCommentInput" title="Bemerkung (wird nicht angezeigt)">
                </div>
                <div class="form-group">
                    <label for="InfoStarttimeInput">Startdatum des Anzeigens:</label>
                    <input type="datetime-local" name="starttime" id="InfoStarttimeInput" title="Datum/Zeit, ab wann die Info angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="InfoEndtimeInput">Enddatum des Anzeigens:</label>
                    <input type="datetime-local" name="endtime" id="InfoEndtimeInput" title="Datum/Zeit, bis wann die Info angezeigt wird">
                </div>
            </form>
            <div class="button-container">
                <button onclick="addInfo()">Hinzufügen</button>
                <button onclick="closePopup('addInfo')">Abbrechen</button>
            </div>
        </div>

        <!-- Popup-Fenster für das editieren einer Info -->
        <div id="editInfo" class="Popup">
            <h3 id="editInfoTitel">Info bearbeiten</h3>
            <form id="editInfoForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="EditInfoTextInput">Text:</label>
                    <input type="text" name="text" id="EditInfoTextInput" title="Text, der auf dem Monitor angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="EditInfoCommentInput">Bemerkung:</label>
                    <input type="text" name="comment" id="EditInfoCommentInput" title="Bemerkung (wird nicht angezeigt)">
                </div>
                <div class="form-group">
                    <label for="EditInfoStarttimeInput">Startdatum des Anzeigens:</label>
                    <input type="datetime-local" name="starttime" id="EditInfoStarttimeInput" title="Datum/Zeit, ab wann die Info angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="EditInfoEndtimeInput">Enddatum des Anzeigens:</label>
                    <input type="datetime-local" name="endtime" id="EditInfoEndtimeInput" title="Datum/Zeit, bis wann die Info angezeigt wird">
                </div>
                <div id="infoId" class="metadata" style="display: none;"></div>
            </form>
            <div class="button-container">
                <button onclick="editInfo()">Ändern</button>
                <button onclick="closePopup('editInfo')">Abbrechen</button>
            </div>
        </div>

        <!-- Info-Fenster für das hinzufügen einer Datei via Drag and drop -->
        <div id="dropHint" class="Popup">
            <h3 id="dropHintTitle">Datei hierhin ziehen, um hochzuladen</h3>
        </div>

        <!-- Popup-Fenster für das hinzufügen einer Bild-Slide -->
        <div id="addImageSlide" class="Popup">
            <h3 id="addImageSlideTitel">Bild-Slide hinzufügen</h3>
            <form id="addImageSlideForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="ImageFileInput" class="mandatory">Bilddatei:</label>
                    <input type="file" name="file" id="ImageFileInput" title="Bilddatei, die als Slide angezeigt werden soll">
                </div>
                <div class="form-group">
                    <label for="ImageTitleInput">Folientitel:</label>
                    <input type="text" name="title" id="ImageTitleInput" title="Titel, der auf der Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="ImageCommentInput">Bemerkung:</label>
                    <input type="text" name="comment" id="ImageCommentInput" title="Bemerkung (wird nicht angezeigt)">
                </div>
                <div class="form-group">
                    <label for="ImageDisplaydurationInput">Anzeigedauer (Sekunden):</label>
                    <input type="number" name="displayduration" id="ImageDisplaydurationInput" min="1" title="Anzeigedauer der Slide in Sekunden">
                </div>
                <div class="form-group">
                    <label for="ImageStarttimeInput">Startdatum des Anzeigens:</label>
                    <input type="datetime-local" name="starttime" id="ImageStarttimeInput" title="Datum/Zeit, ab wann die Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="ImageEndtimeInput">Enddatum des Anzeigens:</label>
                    <input type="datetime-local" name="endtime" id="ImageEndtimeInput" title="Datum/Zeit, bis wann die Folie angezeigt wird">
                </div>
            </form>
            <div class="button-container">
                <button onclick="addImageSlide()">Hinzufügen</button>
                <button onclick="closePopup('addImageSlide')">Abbrechen</button>
            </div>
        </div>

        <!-- Popup-Fenster für das hinzufügen einer Video-Slide -->
        <div id="addVideoSlide" class="Popup">
            <h3 id="addVideoSlideTitel">Video-Slide hinzufügen</h3>
            <form id="addVideoSlideForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="VideoFileInput" class="mandatory">Videodatei:</label>
                    <input type="file" name="file" id="VideoFileInput" title="Videodatei, die als Slide angezeigt werden soll">
                </div>
                <div class="form-group">
                    <label for="VideoTitleInput">Folientitel:</label>
                    <input type="text" name="title" id="VideoTitleInput" title="Titel, der auf der Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="VideoCommentInput">Bemerkung:</label>
                    <input type="text" name="comment" id="VideoCommentInput" title="Bemerkung (wird nicht angezeigt)">
                </div>
                <div class="form-group">
                    <label for="VideoDisplaydurationInput">Anzeigedauer (Sekunden) falls nicht Gesamtlänge:</label>
                    <input type="number" name="displayduration" id="VideoDisplaydurationInput" min="1" title="Anzeigedauer der Slide in Sekunden (Standardmässig wird das ganze Video abgespielt, bevor die Slide gewechselt wird)">
                </div>
                <div class="form-group">
                    <label for="VideoStarttimeInput">Startdatum des Anzeigens:</label>
                    <input type="datetime-local" name="starttime" id="VideoStarttimeInput" title="Datum/Zeit, ab wann die Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="VideoEndtimeInput">Enddatum des Anzeigens:</label>
                    <input type="datetime-local" name="endtime" id="VideoEndtimeInput" title="Datum/Zeit, bis wann die Folie angezeigt wird">
                </div>
            </form>
            <div class="button-container">
                <button onclick="addVideoSlide()">Hinzufügen</button>
                <button onclick="closePopup('addVideoSlide')">Abbrechen</button>
            </div>
        </div>

        <!-- Popup-Fenster für das hinzufügen einer Iframe-Slide -->
        <div id="addIframeSlide" class="Popup">
            <h3 id="addIframeSlideTitel">Iframe-Slide hinzufügen</h3>
            <form id="addIframeSlideForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="IframeUrlInput" class="mandatory">URL:</label>
                    <input type="url" name="url" id="IframeUrlInput" title="URL, due als Slide angezeigt werden soll">
                </div>
                <div class="form-group">
                    <label for="IframeTitleInput">Folientitel:</label>
                    <input type="text" name="title" id="IframeTitleInput" title="Titel, der auf der Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="IframeCommentInput">Bemerkung:</label>
                    <input type="text" name="comment" id="IframeCommentInput" title="Bemerkung (wird nicht angezeigt)">
                </div>
                <div class="form-group">
                    <label for="IframeDisplaydurationInput">Anzeigedauer (Sekunden):</label>
                    <input type="number" name="displayduration" id="IframeDisplaydurationInput" min="1" title="Anzeigedauer der Slide in Sekunden">
                </div>
                <div class="form-group">
                    <label for="IframeStarttimeInput">Startdatum des Anzeigens:</label>
                    <input type="datetime-local" name="starttime" id="IframeStarttimeInput" title="Datum/Zeit, ab wann die Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="IframeEndtimeInput">Enddatum des Anzeigens:</label>
                    <input type="datetime-local" name="endtime" id="IframeEndtimeInput" title="Datum/Zeit, bis wann die Folie angezeigt wird">
                </div>
            </form>
            <div class="button-container">
                <button onclick="addIframeSlide()">Hinzufügen</button>
                <button onclick="closePopup('addIframeSlide')">Abbrechen</button>
            </div>
        </div>

        <!-- Popup-Fenster für das editieren einer Slide -->
        <div id="editSlide" class="Popup">
            <h3 id="editSlideTitel">Slide bearbeiten</h3>
            <form id="editSlideForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="SlideTitleInput">Folientitel:</label>
                    <input type="text" name="title" id="SlideTitleInput" title="Titel, der auf der Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="SlideCommentInput">Bemerkung:</label>
                    <input type="text" name="comment" id="SlideCommentInput" title="Bemerkung (wird nicht angezeigt)">
                </div>
                <div class="form-group">
                    <label for="SlideDisplaydurationInput">Anzeigedauer (Sekunden):</label>
                    <input type="number" name="displayduration" id="SlideDisplaydurationInput" min="1" title="Anzeigedauer der Slide in Sekunden">
                </div>
                <div class="form-group">
                    <label for="SlideStarttimeInput">Startdatum des Anzeigens:</label>
                    <input type="datetime-local" name="starttime" id="SlideStarttimeInput" title="Datum/Zeit, ab wann die Folie angezeigt wird">
                </div>
                <div class="form-group">
                    <label for="SlideEndtimeInput">Enddatum des Anzeigens:</label>
                    <input type="datetime-local" name="endtime" id="SlideEndtimeInput" title="Datum/Zeit, bis wann die Folie angezeigt wird">
                </div>
                <div id="slideId" class="metadata" style="display: none;"></div>
            </form>
            <div class="button-container">
                <button onclick="editSlide()">Ändern</button>
                <button onclick="closePopup('editSlide')">Abbrechen</button>
            </div>
        </div>

        <!-- Popup-Fenster für die Bestätigungsmeldungen -->
        <div id="confirmationMessage" class="Popup">
            <h3 id="confirmationMessageTitel"></h3>
            <p id="confirmationMessageText"></p>
            <div class="button-container">
                <button id="closeConfirmationMessage" onclick="closeConfirmationMessage()">Schliessen</button>
            </div>
            <script>
                // Schliesse Popup mit Enter
                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Enter') {
                        const popup = document.getElementById('confirmationMessage');
                        if (popup && window.getComputedStyle(popup).display !== 'none') {
                            document.getElementById('closeConfirmationMessage').click();
                        }
                    }
                });
            </script>
        </div>

    </body>
</html>